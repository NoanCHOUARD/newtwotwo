<html>
  <head>
    <title>Setup</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>

    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>

  </head>
  <body>
  <a-scene
  >

    <a-asset>

      <!-- Structures -->

      <a-asset-item id="bat1" src="./assets/bati1.glb"></a-asset-item>
      <a-asset-item id="bat2" src="./assets/bati2.glb"></a-asset-item>
      <a-asset-item id="bat3" src="./assets/bati3.glb"></a-asset-item>
      <a-asset-item id="bat4" src="./assets/bati4.glb"></a-asset-item>
      <a-asset-item id="bat5" src="./assets/bati5.glb"></a-asset-item>

      <!-- Objets -->
      <a-asset-item id="cycle" src="./assets/standard_lightcycle__tron_evoluton_battle_grids.glb"></a-asset-item>
      <a-asset-item id="cyleorange" src="./assets/moto-orange-test.glb"></a-asset-item>
      
      <a-asset-item id="car" src="./assets/light_runner_v1__tron_evolution_battle_grids.glb"></a-asset-item>
      
      <a-asset-item id="disk" src="./assets/tron_legacy_identity_disc.glb"></a-asset-item>
      <a-asset-item id="diskorange" src="./assets/disk-orange.glb"></a-asset-item>
      <a-asset-item id="diskgreen" src="./assets/disk-green.glb"></a-asset-item>
      <a-asset-item id="diskpurple" src="./assets/disk-purple.glb"></a-asset-item>
      
      <a-asset-item id="chara" src="./assets/tron_character.glb"></a-asset-item>
      
      <a-asset-item id="avion1" src="./assets/one_man_light_jet_tron.glb"></a-asset-item>
      <a-asset-item id="avion2" src="./assets/three_man_light_jet_tron.glb"></a-asset-item>

      <!-- Socle -->
      <a-asset-item id="socle-obj1" src="./assets/socle1.obj"></a-asset-item>
      <a-asset-item id="socle-mtl1" src="./assets/socle1.mtl"></a-asset-item>

      <a-asset-item id="socle-obj2" src="./assets/socle2.obj"></a-asset-item>
      <a-asset-item id="socle-mtl2" src="./assets/socle2.mtl"></a-asset-item>

      <!-- Audio -->
      <audio id="music" src="./assets/Smooth and Cool - Nico Staf.mp3" preload="auto"></audio>  
      <audio id="sound" src="./assets/33478__hiccupvirus__original-tron-bike-engine.wav" preload="auto"></audio>    
    </a-asset>

    <!-- environnement -->

    <a-entity 
      environment="
      preset: tron;
      groundColor: #000; 
      grid: 1x1;
      dressing: none;
      gridColor: #F3FBFD;
      horizonColor: #055373; 
      skyColor: #040b07; 
      stageSize: 200;
      seed: 1;
      skyType: gradient;
      lightPosition: 0 20 0;
      ground: spikes;
      groundYScale: 5;
      groundColor: #000;
      fog: 0.8;
      dressingVariance: 0.5;
      "
      >
    </a-entity>

    <a-entity 
      id="background-music"
      sound="src: #music; autoplay: true; loop: true; volume: 0.1; maxDistance: 1000; positional: false"      >
    </a-entity>

    <!-- Ligne endroit 2 -->

    <a-sphere
      position="0 0.04 -12.5"
      radius="0.1"
      color="#F3FBFD"
      >
    </a-sphere>

    <a-box
      position="0 0.06 -15.5"
      width="0.06"
      height="0.06"
      depth="6"
      rotation="0 0 0"
      color="#F3FBFD">
    </a-box>

    <a-sphere
      position="0 0.080 -18.490"
      radius="0.12"
      color="#F3FBFD"
      >
    </a-sphere>

    <a-box
      position="15.922 0.130 -34.338"
      width="0.06"
      height="0.06"
      depth="45"
      rotation="0 -45 0"
      color="#F3FBFD">
    </a-box>

    <a-sphere
      position="30.658 0.163 -49.099"
      radius="0.1"
      color="#F3FBFD"
      >
    </a-sphere>

    <!-- Bat1 -->

    <a-entity
      gltf-model="#bat1"
      position="50 -0.5 -50"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <a-entity
      gltf-model="#bat1"
      position="15 -0.5 -60"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <a-entity
      gltf-model="#bat1"
      position="51.524 -0.5 -80"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <!-- Moto anim 1 -->
    <a-entity
      position="50.160 0 -66.216"
      rotation="0 135 0"
      gltf-model="#cycle"
      scale="0.2 0.2 0.2"
      data-hover-scale="0.22 0.22 0.22"
      data-light-color="#F3FBFD"
      rotating-around="center: 50.160 0 -66.216; radius: 12; speed: 1.2"
      class="clickable"
      data-cible="cible2"
      interactable
      sound="src: #sound; maxDistance: 15; volume: 0.5 positional: true"
      >
    </a-entity>

    <!-- Moto anim 2 -->
    <a-entity
      position="50.160 0 -66.216"
      rotation="0 135 0"
      gltf-model="#cyleorange"
      scale="0.2 0.2 0.2"
      rotating-around="center: 50.160 0 -66.216; radius: 15; speed: 1.5"
      >
    </a-entity>

    <!-- Bat2 -->
    
    


    <!-- Bat3 -->
    <a-entity
      gltf-model="#bat3"
      position="50 -0.5 50"
      rotation="0 90 0"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <!-- Bat4 -->
    <a-entity
      gltf-model="#bat4"
      position="-50 -0.5 -32.190"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <a-entity
      gltf-model="#bat4"
      position="-85.583 -0.5 -32.190"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <a-entity
      gltf-model="#bat4"
      position="-50 -0.5 -76.780"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <a-entity
      gltf-model="#bat4"
      position="-85.583 -0.5 -76.780"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <!-- Zone de combat -->

      <a-box 
        position="-54.06538 0.96366 -56.71039" 
        width="0.06" 
        height="0.06" 
        depth="6" 
        rotation="0 0 0" 
        color="#F3FBFD" 
        geometry="depth: 2; height: 2; width: 2">
      </a-box>

      <a-box 
        position="-59.85171 1.77705 -47.37546" 
        width="0.06" 
        height="0.06" 
        depth="6" 
        rotation="0 0 0" 
        color="#F3FBFD" 
        geometry="depth: 2; height: 4; width: 2">
      </a-box>

      <a-box 
        position="-74.19477 1.77705 -41.87126" 
        width="0.06" 
        height="0.06" 
        depth="6" 
        rotation="0 0 0" 
        color="#F3FBFD" 
        geometry="depth: 2; height: 4; width: 5">
      </a-box>

      <a-box 
        position="-80.25489 4.98139 -52.16522" 
        width="0.06" 
        height="0.06" 
        rotation="0 0 0" 
        color="#ff7f00" 
        geometry="depth: 2; height: 10; width: 2">
      </a-box>

      <a-box 
        position="-75.47146 0.96366 -62.83942" 
        width="0.06" 
        height="0.06" 
        depth="6" 
        rotation="0 0 0" 
        color="#00ff00" 
        geometry="depth: 2; height: 2; width: 2">
      </a-box>

      <a-box 
        position="-62.40056 1.77705 -67.42871" 
        width="0.06" 
        height="0.06" 
        depth="6" 
        rotation="0 90 0" 
        color="#8A00C4" 
        geometry="depth: 2; height: 4; width: 5">
      </a-box>

      <!-- Disque bleu -->
      <a-entity
        gltf-model="#disk"
        position="-61.286 0.320 -48.1"
        scale="0.4 0.4 0.4"
        rotation="35 -120 5"
        >
      </a-entity>

      <!-- Disque orange -->
      <a-entity
        gltf-model="#diskorange"
        position="-79.064 0.688 -51.879"
        scale="0.4 0.4 0.4"
        rotation="0 0 -75">
      </a-entity>

      <!-- Disque vert -->
      <a-entity
        data-hover-scale="0.45 0.45 0.45"
        data-light-color="#00ff00"
        class="clickable"
        data-cible="cible3"
        interactable
        gltf-model="#diskgreen"
        position="-75.471 0.592 -63.994"
        scale="0.4 0.4 0.4"
        rotation="0 90 -75"
        >
      </a-entity>

      <!-- Disque violet -->
      <a-entity
        gltf-model="#diskpurple"
        position="-61.221 0.677 -67.429"
        scale="0.4 0.4 0.4"
        rotation="0 0 -75"
        >
      </a-entity>

    <!-- Bat5 -->
    <a-entity
      gltf-model="#bat5"
      position="35 -0.5 35"
      scale="0.4 0.4 0.4"
      >
    </a-entity>
      
    <a-entity
      gltf-model="#bat5"
      position="65 -0.5 35"
      scale="0.4 0.4 0.4"
      >
    </a-entity>

    <!-- Avion 1 -->
    <a-entity
        gltf-model="#avion1"
        position="50 0 35"
        scale="0.01 0.01 0.01"
        flying="speed: 0.5"
      >
    </a-entity>

    <!-- Avion 2 -->
    <a-entity
      class="clickable"
      data-cible="cible1"
      gltf-model="#avion1"
      position="50 3 35"
      scale="0.01 0.01 0.01"
      rotation="0 45 0"
      data-hover-scale="0.011 0.011 0.011"
      data-light-color="#ff7f00"
      interactable
      floating="amplitude: 0.009 speed: 0.009"
      >
    </a-entity>

    <!-- Avion 3 -->

    <a-entity
        gltf-model="#avion2"
        position="0 30 0"
        scale="0.01 0.01 0.01"
        flyingtwo="speed: 0.5"
      >
    </a-entity>

    <!-- Avion 4 -->

    <a-entity
        gltf-model="#avion2"
        position="0 32 0"
        scale="0.01 0.01 0.01"
        rotation="0 45 0"
        flyingthree="speed: 1"
      >
    </a-entity>

    <!-- Voiture active -->

    <a-entity
      position="-8 0 8"
      rotation="0 -145 0"
      scale="10 10 10"
      gltf-model="#car"
      rotating-around="center: 0 0 0; radius: 28; speed: 1"
      >
    </a-entity>

    <!--Anim text -->

    <a-entity
        id="introText"
        text="value: Explorez et cherchez les 3 objets de l'univers de TRON. 
        Cliquez sur les objets similaires en dehors de la zone avec le curseur, pour faire apparaitre les orbes manquantes de couleurs.; color: #55E2DB; width: 7; align: center; wrapCount: 50"
        position="0 2 5"
        rotation="0 180 0"
        opacity-fade="duration: 5000; delay: 15000"
      ></a-entity>

    <!-- Ligne 1 -->
    <a-box
      position="0 0.02 0"
      width="0.05"
      height="0.05"
      depth="25"
      color="#F3FBFD"
      >
    </a-box>

    <!-- Ligne 2 -->
    <a-box
      position="0 0.02 0"
      rotation="0 -90 0"
      width="0.05"
      height="0.05"
      depth="25"
      color="#F3FBFD"
      >
    </a-box>

    <!-- Ligne endroit 1 -->

    <a-sphere
      position="12.5 0.04 0"
      radius="0.1"
      color="#ff7f00"
      >
    </a-sphere>

    <a-box
      position="26.5 0.05 0"
      width="0.06"
      height="0.06"
      depth="28"
      rotation="0 90 0"
      color="#ff7f00">
    </a-box>

    <a-sphere
      position="40.482 0.04 0"
      radius="0.1"
      color="#ff7f00"
      >
    </a-sphere>

    <a-box
      position="45.763 0.085 5.291"
      width="0.06"
      height="0.06"
      depth="15"
      rotation="0 45 0"
      color="#ff7f00">
    </a-box>

    <a-sphere
      position="50.074 0.099 9.620"
      radius="0.1"
      color="#ff7f00"
      >
    </a-sphere>

    <a-box
      position="50.073 0.150 17.132"
      width="0.06"
      height="0.06"
      depth="15"
      rotation="0 0 0"
      color="#ff7f00">
    </a-box>

    <a-sphere
      position="50.051 0.138 24.634"
      radius="0.1"
      color="#ff7f00"
      >
    </a-sphere>

    <!-- Ligne endroit 3 -->

    <a-sphere
      position="-12.5 0.04 0"
      radius="0.1"
      color="#00ff00"
      >
    </a-sphere>

    <a-box
      position="-26.5 0.07 0"
      width="0.06"
      height="0.06"
      depth="28"
      rotation="0 -90 0"
      color="#00ff00">
    </a-box>

    <a-sphere
      position="-40.482 0.04 0"
      radius="0.14"
      color="#00ff00"
      >
    </a-sphere>

    <a-box
      position="-45.763 0.120 -5.291"
      width="0.06"
      height="0.06"
      depth="15"
      rotation="0 45 0"
      color="#00ff00">
    </a-box>

    <a-box 
      position="-55.497 0.15 -14.997" 
      width="0.06" 
      height="0.06" 
      depth="15" 
      rotation="0 45 0" 
      color="#00ff00">
    </a-box>

    <a-sphere 
      position="-60.86355 0.18344 -20.33884" 
      radius="0.14" 
      color="#00ff00">
    </a-sphere>

   <!-- Sol  -->
    <a-plane
      position="0 0.01 0"
      rotation="-90 0 0"
      width="26"
      height="26"
      color="#000"
      >
    </a-plane>

    <!-- Sol 2  -->
    <a-plane
      position="0 0.02 0"
      rotation="-90 0 0"
      width="25.5"
      height="25.5"
      color="#F3FBFD"
      >
    </a-plane>

    <!-- Sol 3  -->
    <a-plane
      position="0 0.03 0"
      rotation="-90 0 0"
      width="25"
      height="25"
      color="#000"
      >
    </a-plane>

    <!-- Porte 1 -->
    <a-entity
      gltf-model="#bat3"
      position="0 -0.5 -13"
      rotation="0 90 0"
      scale="0.2 0.2 0.2"
      >
    </a-entity>

    <!-- Porte 2 -->
    <a-entity
      gltf-model="#bat3"
      position="12.5 -0.5 0"
      rotation="0 180 0"
      scale="0.2 0.2 0.2"
      >
    </a-entity>

    <!-- Porte 3 -->
    <a-entity
      gltf-model="#bat3"
      position="-12.5 -0.5 0"
      rotation="0 0 0"
      scale="0.2 0.2 0.2"
      >
    </a-entity>

    <!-- Mur 1 -->

    <a-box
      position="8 0.5 -12"
      width="10"
      height="10"
      depth="0.2"
      color="#55E2DB"
      
      >
    </a-box>

    <a-box
      position="8 0.5 -12"
      width="10"
      height="8"
      depth="0.6"
      color="#000"
      >
    </a-box>

    <!-- Mur 2 -->

    <a-box 
      position="-0.03973 0.5 12" 
      width="10" 
      height="10" 
      depth="0.2" 
      color="#55E2DB" 
      geometry="width: 20">
    </a-box>

    <a-box 
      position="-0.04476 0.5 12" 
      width="10" 
      height="8" 
      depth="0.6" 
      color="#000" 
      geometry="width: 20">
    </a-box>

    <a-box
      position="12 0.5 8"
      width="0.6"
      height="8"
      depth="10"
      color="#000"
      >
    </a-box>

    <!-- Mur 4 -->

    <a-box
      position="-12 0.5 8"
      width="0.2"
      height="10"
      depth="10"
      color="#55E2DB"
      >
    </a-box>

    <a-box
      position="-12 0.5 8"
      width="0.6"
      height="8"
      depth="10"
      color="#000"
      >
    </a-box>
    
    <!-- Mur 5 -->

    <a-box
      position="-8 0.5 12"
      width="0.2"
      height="10"
      depth="10"
      rotation="0 90 0"
      color="#55E2DB"
      >
    </a-box>

    <a-box
      position="-8 0.5 12"
      width="0.6"
      height="8"
      depth="10"
      rotation="0 90 0"
      color="#000"
      >
    </a-box>

    <!-- Mur 6 -->

    <a-box
      position="-8 0.5 -12"
      width="0.2"
      height="10"
      depth="10"
      rotation="0 90 0"
      color="#55E2DB"
      >
    </a-box>

    <a-box
      position="-8 0.5 -12"
      width="0.6"
      height="8"
      depth="10"
      rotation="0 90 0"
      color="#000"
      >
    </a-box>

    <!-- Mur 7 -->

    <a-box
      position="12 0.5 -8"
      width="0.2"
      height="10"
      depth="10"
      rotation="0 180 0"
      color="#55E2DB"
      >
    </a-box>

    <a-box
      position="12 0.5 -8"
      width="0.6"
      height="8"
      depth="10"
      rotation="0 180 0"
      color="#000"
      >
    </a-box>

    <!-- Mur 8 -->

    <a-box
      position="-12 0.5 -8"
      width="0.2"
      height="10"
      depth="10"
      rotation="0 180 0"
      color="#55E2DB"
      >
    </a-box>

    <a-box
      position="-12 0.5 -8"
      width="0.6"
      height="8"
      depth="10"
      rotation="0 180 0"
      color="#000"
      >
    </a-box>

    <!-- Tour 1 -->

    <a-box
      position="12 0.5 12"
      width="3.5"
      height="11"
      depth="3.5"
      color="#ff7f00"
      light="type: ambient; color: #ff7f00"
      >
    </a-box>

    <a-box
      position="12 0.5 12"
      width="3.8"
      height="8"
      depth="3.8"
      color="#000"
      >
    </a-box>

    <a-sphere
      id="cible1"
      visible="false"
      position="12 8 12"
      radius="1"
      color="#ff7f00"
      >
    </a-sphere>

    <!-- Tour 2 -->
     
    <a-box
      position="-12 0.5 12"
      width="3.5"
      height="11"
      depth="3.5"
      color="#8A00C4"
      light="type: ambient; color: #8A00C4"
      >
    </a-box>

    <a-box
      position="-12 0.5 12"
      width="3.8"
      height="8"
      depth="3.8"
      color="#000"
      >
    </a-box>

    <a-sphere
      position="-12 8 12"
      radius="1"
      color="#8A00C4"
      >
    </a-sphere>

    <!-- Tour 3 -->

    <a-box
      position="12 0.5 -12"
      width="3.5"
      height="11"
      depth="3.5"
      color="#55E2DB"
      light="type: ambient; color: #55E2DB"
      >
    </a-box>

    <a-box
      position="12 0.5 -12"
      width="3.8"
      height="8"
      depth="3.8"
      color="#000"
      >
    </a-box>

    <a-sphere
      id="cible2"
      visible="false"
      position="12 8 -12"
      radius="1"
      color="#55E2DB"
      >
    </a-sphere>

    <!-- Tour 4 -->

    <a-box
      position="-12 0.5 -12"
      width="3.5"
      height="11"
      depth="3.5"
      color="#00ff00"
      light="type: ambient; color: #00ff00"
      >
    </a-box>

    <a-box
      position="-12 0.5 -12"
      width="3.8"
      height="8"
      depth="3.8"
      color="#000"
      >
    </a-box>

    <a-sphere
      id="cible3"
      visible="false"
      position="-12 8 -12"
      radius="1"
      color="#00ff00"
      >
    </a-sphere>

    <!-- <a-obj-model src="#socle-obj2" mtl="#socle-mtl2" position="0 0 0" scale="1 1 1"></a-obj-model> -->
     
    <!-- Disque -->

    <a-circle
      position="8 0.04 8"
      rotation="-90 0 0"
      radius="1"
      color="#F3FBFD">
    </a-circle>

    <a-obj-model src="#socle-obj1" mtl="#socle-mtl1" position="8 -0.1 8"></a-obj-model>

    <a-entity
      gltf-model="#disk"
      position="8 1.5 8"
      scale="0.4 0.4 0.4"
      rotation="35 -120 5"
      animdisk="speed: 20"
      >
    </a-entity>

    <!-- Personnage -->

    <a-circle
      position="-8 0.04 -8"
      rotation="-90 0 0"
      radius="1"
      color="#F3FBFD">
    </a-circle>
    
    <a-obj-model src="#socle-obj1" mtl="#socle-mtl1" position="-8 -0.1 -8" scale="1 1 1"></a-obj-model>

    <a-entity
      position="-8 1 -8"
      rotation="0 35 0"
      gltf-model="#chara"
      scale="0.004 0.004 0.004"
      anim="speed: 5"
      >
    </a-entity>

    <!-- Moto -->  
     
    <a-circle
      position="8 0.04 -8"
      rotation="-90 0 0"
      radius="1"
      color="#F3FBFD">
    </a-circle>
    
    <a-obj-model src="#socle-obj1" mtl="#socle-mtl1" position="8 -0.1 -8" scale="1 1 1"></a-obj-model>

    <a-entity
      position="8 0.5 -8"
      rotation="0 -135 0"
      gltf-model="#cycle"
      scale="0.2 0.2 0.2"
      anim="speed: 5"
      >
    </a-entity>

    <!-- Voiture -->

    <a-circle
      position="-8 0.04 8"
      rotation="-90 0 0"
      radius="1"
      color="#F3FBFD">
    </a-circle>
    
    <a-obj-model src="#socle-obj1" mtl="#socle-mtl1" position="-8 -0.1 8" scale="1 1 1"></a-obj-model>

    <a-entity
      position="-8 1.2 8"
      rotation="0 -145 0"
      scale="10 10 10"
      gltf-model="#car"
      anim="speed: 5"
      >
    </a-entity>

    <!-- Zone d'aparition -->

    <a-circle
      position="0 0.06 0"
      rotation="-90 0 0"
      radius="0.7"
      color="#55E2DB">
    </a-circle>

    <a-circle
      position="0 0.05 0"
      rotation="-90 0 0"
      radius="0.8"
      color="#F3FBFD">
      
    </a-circle>

    <a-circle
      position="0 0.04 0"
      rotation="-90 0 0"
      radius="0.9"
      color="#000">
    </a-circle>


    <!-- Joueur -->
    <a-entity id="rig" movement-controls position="0 0 0" rotation="0 180 0">
      <a-entity
        camera
        position="0 1.7 0"
        look-controls="pointerLockEnabled: true"
        cursor="rayOrigin: mouse"
      >
      </a-entity>
      <a-entity
        oculus-touch-controls="hand: left"
        laser-controls="hand: left"
      ></a-entity>
      <a-entity
        oculus-touch-controls="hand: right"
        laser-controls="hand: right"
        raycaster="objects: .clickable; far: 15; showLine: true"
      ></a-entity>
    </a-entity>


  </a-scene>

  <!-- Script de rotation -->

  <script>
    
    // Script de rotation du disque
    AFRAME.registerComponent("animdisk", {
      // objet qui définit les propriétés du composant.
      schema: {
        // Propriété speed de type number avec une valeur par défaut de 1.
        speed: { type: "number", default: 1 },
      },
      // Fonction appelée ts les x ms.
      tick: function (time, timeDelta) {
        // Récupère l'attribut rotation de l'élément.
        let rotation = this.el.getAttribute("rotation");
        // Incrémente la valeur y de l'attribut rotation.
        rotation.y += this.data.speed * (timeDelta / 1000);

        rotation.x += this.data.speed * (timeDelta / 1000);

        let position = this.el.getAttribute("position");

        position.y += Math.sin(time / 1000) * 0.001;

        // Met à jour l'attribut rotation de l'élément.
        this.el.setAttribute("rotation", rotation,);
        this.el.setAttribute("position", position);
      },
    });

    // Script de rotation des objets
    AFRAME.registerComponent("anim",{

      schema: {

        speed: { type: "number", default: 1 },

      },

      tick: function(time, timeDelta){

        let rotation = this.el.getAttribute("rotation");

        rotation.y += this.data.speed * (timeDelta / 1000);

        let position = this.el.getAttribute("position");

        this.el.setAttribute("rotation", rotation);

      }

    })

    AFRAME.registerComponent("flying", {
  schema: {
    speed: { type: "number", default: 1 },
  },
  tick: function (time, timeDelta) {
    let position = this.el.getAttribute("position");
    let rotation = this.el.getAttribute("rotation");

    // Mouvement de vol en cercle autour de la position initiale
    const initialX = 50;
    const initialZ = 35;
    position.x = initialX + Math.sin(time / 1000 * this.data.speed) * 10;
    position.z = initialZ + Math.cos(time / 1000 * this.data.speed) * 10;

    // Mouvement de haut en bas
    position.y = 40 + Math.sin(time / 1000 * this.data.speed) * 10;

    // Rotation pour simuler le vol
    rotation.y = (time / 1000 * this.data.speed * 180 / Math.PI) % 360;

    this.el.setAttribute("position", position);
    this.el.setAttribute("rotation", rotation);
  },
});

AFRAME.registerComponent("flyingtwo", {
  schema: {
    speed: { type: "number", default: 1 },
  },
  tick: function (time, timeDelta) {
    let position = this.el.getAttribute("position");
    let rotation = this.el.getAttribute("rotation");

    // Mouvement de vol en cercle autour de la position initiale
    const initialX = 0;
    const initialZ = 0;
    position.x = initialX + Math.sin(time / 1000 * this.data.speed) * 50;
    position.z = initialZ + Math.cos(time / 1000 * this.data.speed) * 50;

    // Mouvement de haut en bas
    position.y = 20 + Math.sin(time / 1000 * this.data.speed) * 10;

    // Rotation pour simuler le vol
    rotation.y = (time / 1000 * this.data.speed * 180 / Math.PI) % 360;

    this.el.setAttribute("position", position);
    this.el.setAttribute("rotation", rotation);
  },
});

AFRAME.registerComponent("flyingthree", {
  schema: {
    speed: { type: "number", default: 1 },
  },
  tick: function (time, timeDelta) {
    let position = this.el.getAttribute("position");
    let rotation = this.el.getAttribute("rotation");

    // Mouvement de vol en cercle autour de la position initiale
    const initialX = 0;
    const initialZ = 0;
    position.x = initialX + Math.sin(time / 1000 * this.data.speed) * 50;
    position.z = initialZ + Math.cos(time / 1000 * this.data.speed) * 50;

    // Mouvement de haut en bas
    position.y = 18 + Math.sin(time / 1000 * this.data.speed) * 10;

    // Rotation pour simuler le vol
    rotation.y = (time / 1000 * this.data.speed * 180 / Math.PI) % 360;

    this.el.setAttribute("position", position);
    this.el.setAttribute("rotation", rotation);
  },
});

// interaction avec les objets ancien script
    // AFRAME.registerComponent("interactable", {
    //     init: function () {
    //       // Add event listener for the laser interaction
    //       // Change the scale of the box on hover
    //       this.el.addEventListener("mouseenter", () => {
    //         this.el.setAttribute("scale", "0.011 0.011 0.011");
    //         this.el.setAttribute("light","color", "#ff7f00", "distance", "30", "intensity", "20", "type", "spot", "decay", "2"); // Visual feedback
    //       });
    //       // Reset the scale on mouse leave
    //       this.el.addEventListener("mouseleave", () => {
    //         this.el.setAttribute("scale", "0.01 0.01 0.01"); // Reset scale
    //         this.el.removeAttribute("light"); // Remove the light
    //       });

    //       // Add event listener for the click interaction
    //       this.el.addEventListener("click", () => {
    //         // Get the target entity
    //         const target = document.querySelector(
    //           `#${this.el.getAttribute("data-cible")}`
    //         );
    //         // Make the target visible
    //         target.setAttribute("visible", "true");

    //         console.log(target);
    //       });
    //     },
    //   });

    // Ancien code pour l'interaction avec les objets

      AFRAME.registerComponent("interactable", {
        init: function () {
          // Add event listener for the laser interaction
          // Change the scale of the box on hover
          this.el.addEventListener("mouseenter", () => {
            const hoverScale = this.el.getAttribute("data-hover-scale");
            const lightColor = this.el.getAttribute("data-light-color");
            this.el.setAttribute("scale", hoverScale);
            this.el.setAttribute("light", `color: ${lightColor}; distance: 30; intensity: 20; type: spot; decay: 2`); // Visual feedback
          });
          // Reset the scale on mouse leave
          this.el.addEventListener("mouseleave", () => {
            const originalScale = this.el.getAttribute("scale");
            this.el.setAttribute("scale", originalScale); // Reset scale
            this.el.removeAttribute("light"); // Remove the light
          });

          // Add event listener for the click interaction
          this.el.addEventListener("click", () => {
            // Get the target entity
            const target = document.querySelector(
              `#${this.el.getAttribute("data-cible")}`
            );
            // Make the target visible
            target.setAttribute("visible", "true");

            console.log(target);
          });
        },
      });

      // Opacité du texte
      AFRAME.registerComponent("opacity-fade", {
    schema: {
      duration: { type: "number", default: 5000 },
      delay: { type: "number", default: 10000 } // Ajout d'un délai avant de commencer à diminuer l'opacité
    },
    init: function () {
      this.startTime = null;
    },
    tick: function (time, timeDelta) {
      if (!this.startTime) {
        this.startTime = time;
      }

      const elapsed = time - this.startTime;

      if (elapsed < this.data.delay) {
        // Maintenir l'opacité à 100% pendant le délai
        this.el.setAttribute("text", "opacity", 1);
      } else {
        // Commencer à diminuer l'opacité après le délai
        const fadeElapsed = elapsed - this.data.delay;
        const opacity = 1 - fadeElapsed / this.data.duration;

        if (opacity <= 0) {
          this.el.setAttribute("visible", "false");
          this.el.removeAttribute("opacity-fade");
        } else {
          this.el.setAttribute("text", "opacity", opacity);
        }
      }
    }
  });

  AFRAME.registerComponent("floating", {
  schema: {
    amplitude: { type: "number", default: 0.5 },
    speed: { type: "number", default: 1 }
  },
  init: function () {
    // Stocke la position initiale de l'élément
    this.initialPosition = this.el.getAttribute("position");
  },
  tick: function (time, timeDelta) {
    let position = this.el.getAttribute("position");

    // Mouvement de haut en bas pour simuler la flottabilité
    position.y = this.initialPosition.y + Math.sin(time / 1000 * this.data.speed) * this.data.amplitude;

    this.el.setAttribute("position", position);
  }
});

AFRAME.registerComponent("rotating-around", {
        schema: {
          center: { type: "vec3" },
          radius: { type: "number", default: 10 },
          speed: { type: "number", default: 1 }
        },
        init: function () {
          // Stocke la position initiale de l'élément
          this.angle = 0;
        },
        tick: function (time, timeDelta) {
          this.angle += this.data.speed * (timeDelta / 1000);

          let position = this.el.getAttribute("position");
          position.x = this.data.center.x + Math.sin(this.angle) * this.data.radius;
          position.z = this.data.center.z + Math.cos(this.angle) * this.data.radius;

          // Rotation pour simuler la direction du modèle
          let rotation = this.el.getAttribute("rotation");
          rotation.y = (this.angle * 180 / Math.PI + 90) % 360;

          this.el.setAttribute("position", position);
          this.el.setAttribute("rotation", rotation);
        }
      });

  </script>

  </body>
</html>